---
- name: Deploy Full Monitoring and Observability Stack
  hosts: all
  become: true
  roles:
    - { role: monitoring-stack, tags: ["monitoring"] }
  
  post_tasks:
    - name: Validate monitoring stack deployment
      include_role:
        name: monitoring-stack
        tasks_from: validate
      tags: ["validate", "never"]
      when: monitoring_config.validate_deployment | default(true)
    
    - name: Display deployment summary
      debug:
        msg:
          - "=== Monitoring Stack Deployment Complete ==="
          - "Prometheus: http://{{ ansible_default_ipv4.address }}:9090"
          - "Grafana: http://{{ ansible_default_ipv4.address }}:3000 (admin/admin)"
          - "Alertmanager: http://{{ ansible_default_ipv4.address }}:9093"
          - "Loki: http://{{ ansible_default_ipv4.address }}:3100"
          - "Run with --tags validate to validate deployment" 