---
all:
  hosts:
    ubuntu-4gb-hel1-1: 
      ansible_host: 46.62.225.143
      ansible_port: 22
      ansible_user: root
      ansible_become: true
      ansible_become_method: sudo
      iptables_docker_public_tcp_ports:
        - 22 
  vars:
    # Common variables for all hosts
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'
    ansible_python_interpreter: /usr/bin/python3
    
    # Reverse proxy selection for this environment
    # Options: "traefik" (default), "nginx", or "none"
    reverse_proxy: "nginx"
    restic_aws_access_key_id: ""
    restic_aws_secret_access_key: ""
    restic_password: ""
    restic_setup_selectel_ca: false
    project_name: rasul
    
    # Tailscale configuration
    tailscale_auth_key: "tskey-auth-kULrHarzRV11CNTRL-AMvcYei9s2iNBejXnpWP3iJA1vadJnZa"
    tailscale_install_url: "https://tailscale.com/install.sh"
    
    # Domain configuration (shared for both Traefik and Nginx)
    domain: "test.projectdot.work"
    
    # Traefik configuration
    traefik_domain: "{{ domain }}"
    traefik_acme_email: "admin@test.projectdot.work"
    traefik_acme_use_staging: true  # Set to true for testing, false for production
    traefik_dashboard_password: "SecureAdminPass123!"  # Change this to your secure password
    
    # Nginx + Certbot configuration
    # Nginx sites and upstreams are auto-generated by the nginx role based on:
    # - nginx_domain (set below)
    # - grafana_enable_reverse_proxy (when reverse_proxy=nginx)
    # - grafana_path (default: /grafana)
    # You can override nginx_sites and nginx_upstreams in inventory if needed
    nginx_domain: "{{ domain }}"
    certbot_domains:
      - "{{ domain }}"
    certbot_mail: "admin@test.projectdot.work"
    certbot_use_staging: true  # Use Let's Encrypt staging for testing (set to false for production)
    # Note: Certbot uses CLOUDFLARE_KIMDEVS environment variable for DNS validation
    # Make sure this is set in your environment when running ansible
    
    # Docker Registry configuration (S3 storage)
    docker_registry_data_dir: "/opt/docker-registry"
    docker_registry_s3_bucket: "docker-registry-bucket"  # UPDATE: Set your S3 bucket name
    docker_registry_s3_region: "us-east-1"  # UPDATE: Set your S3 region
    docker_registry_s3_access_key: ""  # UPDATE: Set your S3 access key
    docker_registry_s3_secret_key: ""  # UPDATE: Set your S3 secret key
    
    # Alertmanager configuration (optional - leave empty to disable notifications)
    alertmanager_data_dir: "/opt/monitoring/alertmanager"
    alertmanager_user: "alertmanager"
    alertmanager_group: "alertmanager"
    # Email notifications (optional)
    alertmanager_email_smtp: ""
    alertmanager_email_from: ""
    alertmanager_email_to: ""
    alertmanager_email_auth_username: ""
    alertmanager_email_auth_password: ""
    # Telegram notifications (optional)
    alertmanager_telegram_bot_token: ""
    alertmanager_telegram_chat_id: 0
    
    # Grafana configuration
    grafana_data_dir: "/opt/monitoring/grafana"
    grafana_user: "grafana"
    grafana_group: "grafana"
    
    # Grafana routing configuration
    # Option 1: Path-based routing (RECOMMENDED for IP/VPN access)
    # Works with both domain AND IP addresses (e.g., https://test.projectdot.work/grafana or http://10.0.0.1/grafana)
    grafana_routing_mode: "path"  # Options: "path" or "domain"
    grafana_path: "/grafana"
    grafana_base_domain: "{{ domain }}"  # Uses main domain
    
    # Option 2: Domain-based routing (e.g., https://test-monitoring.projectdot.work)
    # Note: Domain routing ONLY works with domain names. For IP/VPN access, use path-based routing (Option 1).
    # grafana_routing_mode: "domain"
    # grafana_domain: "test-monitoring.projectdot.work"
    
    grafana_enable_reverse_proxy: true

    # WireGuard configuration (optional - set if you want to deploy WireGuard)
    wireguard_address: "10.0.0.1/24"  # VPN server IP address
    wireguard_port: "51820"           # UDP port for WireGuard
    wireguard_interface: "wg0"        # WireGuard interface name
    wireguard_manage_iptables: true   # Whether WireGuard should manage iptables (set false if iptables role already configured)
    # wireguard_private_key: ""       # Optional: Leave empty to auto-generate, or provide existing key